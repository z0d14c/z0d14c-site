---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro:assets';

interface Props {
  images: ImageMetadata[];
}

const { images } = Astro.props;
---

<div class='carousel'>
  {images.map((img, idx) => (
    <div class:list={[ 'carousel-img', idx !== 0 && 'hidden' ]}>
      <Image src={img} alt='' width={800} height={400} class='rounded border-2 border-black w-full h-64 object-cover' />
    </div>
  ))}
  {images.length > 1 && (
    <div class='flex justify-between mt-2'>
      <button class='prev border-2 border-black px-4 py-2 bg-white card-shadow'>Prev</button>
      <button class='next border-2 border-black px-4 py-2 bg-white card-shadow'>Next</button>
    </div>
  )}
</div>

<script>
  document.addEventListener('astro:page-load', () => {
    const carousel = document.currentScript?.parentElement;
    if (!carousel) return;
    const imgs = carousel.querySelectorAll('.carousel-img');
    if (imgs.length === 0) return;
    let current = 0;
    const show = () => {
      imgs.forEach((el, i) => {
        el.style.display = i === current ? 'block' : 'none';
      });
    };
    show();
    const prev = carousel.querySelector('.prev');
    const next = carousel.querySelector('.next');

    prev?.addEventListener('click', () => {
      current = (current - 1 + imgs.length) % imgs.length;
      show();
    });
    next?.addEventListener('click', () => {
      current = (current + 1) % imgs.length;
      show();
    });
  });
</script>
