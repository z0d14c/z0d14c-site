---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro:assets';
import '@splidejs/splide/css';

interface Props {
  images: ImageMetadata[];
}

const { images } = Astro.props;
---

<div class='splide'>
  <div class='splide__track'>
    <ul class='splide__list'>
      {images.map((img) => (
        <li class='splide__slide'>
          <Image src={img} alt='' width={800} height={400} class='rounded border-2 border-black w-full h-64 object-cover' />
        </li>
      ))}
    </ul>
  </div>
</div>

<script define:vars>
  import Splide from '@splidejs/splide';

  const initCarousel = () => {
    const root = document.currentScript?.parentElement;
    if (!root) return;
    const splideEl = root.querySelector('.splide');
    if (!splideEl) return;
    new Splide(splideEl, { type: 'loop' }).mount();
  };

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCarousel);
  } else {
    initCarousel();
  }
</script>
